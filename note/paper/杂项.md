# 杂项
- [杂项](#杂项)
- [数的直径](#数的直径)
- [哈希](#哈希)
- [模拟退火](#模拟退火)
- [集合枚举](#集合枚举)


# 数的直径
1. 使用树形 $dp$。
2. 两次 $dfs$。第一个找到一个直径端点，第二次从该点找另一个直径端点。此方式方便保存直径的路径信息，但是树中边权不能为负数。

# 哈希
1. 树的哈希：$h_u=1+\sum\limits_{v \in child_u} shift(h_v)$，其中 $shift$ 是 $Xor$ $shift$ 函数。
2. 无序集合的哈希
   - 无重复元素的集合：为每种元素赋一个哈希值，集合元素哈希值取异或和得到集合哈希值
   - 有重复元素的集合：为每种元素赋一个哈希值，集合元素哈希值求和（开i128，或者自然溢出）得到集合哈希值

# 模拟退火
模拟退火是通过随机数生成一些新的状态，计算新状态的价值，若新状态价值比答案更优，更新答案。  
此外每次模拟退火会设一个当前状态 $curS$ ，初始为之前保存的最优状态；  
当产生新状态 $nextS$ 时，若价值比 $curS$ 更优秀，改变 $curS \leftarrow nextS$，否则以 $e^{-\frac{\Delta}{T}}$ 的概率改变 $curS \leftarrow nextS$。  
其中 $\Delta$ 表示 $curS$ 和 $nextS$ 的价值差，他的正负取决于答案说越小越好还是越大越好。

新状态的产生，根据状态的价值函数是否连续，选择如下方式
1. 如果连续，$nextS$ 可以在 $curS$ 上加偏移量产生。
2. 如果不连续，可以全局随机选取。

常见问题对应的随机方式：
1. 对一个序列进行分组使得分组结果价值最大/最小。例题：[Interval Addition](https://contest.ucup.ac/submission/209249)  [均分数据](https://www.luogu.com.cn/problem/P2503)
   1. 每次随机交换两个位置的数，分组时按区间划分，这里可尝试 $DP$。
   2. 每次随机改变一个元素所属组别。
   3. 直接 shuffle。
    
2. 二维平面上寻找一个最优点。例题：[平衡点](https://www.luogu.com.cn/problem/P1337)  [炸弹攻击](https://loj.ac/p/2076)  
   1. 每次随机对当前点加偏移量，另外，产生修改 $mt,t0,dt$ 来优化最终效果，最后可以在已知最优状态附近再小范围随机调整答案。


# 集合枚举
1. 枚举子集：$i \leftarrow (i-1)\And s$，注意看是否需要枚举空集来设置循环条件。枚举 $1 \sim 2^n-1$ 的所有数的子集总复杂度是 $O(3^n)$ 级别的。
2. 枚举超集：$i \leftarrow (i+1) | s$。
3. 枚举集合大小为 $k$ 的集合：初始 $i$ 为 `1<<k`，定义 $x$ 为 `i&-i`，$y$ 为 `x+i`，那么下一个比 $i$ 大的 $k-$集合 为 `((i & ~y) / x >> 1)|y`，迭代 $i$ 遍历即可。



